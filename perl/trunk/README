###############################################################################
# nagios_downtime 0.5
# 2009-10-14 Lars Michelsen <lars@vertical-visions.de>
###############################################################################

###############################################################################
# Description

nagios_downtime can be used to schedule downtimes directly from monitored
machines to automaticaly schedule downtimes in Nagios only with having access
to the Nagios CGIs. There is no additional connection needed.

You can schedule those downtimes automaticaly on system reboot by an init
script. You could also run the script to schedule downtimes for special
services e.g. during backups of databases. nagios_downtime can create a
downtime in Nagios before shuting down the database to start the backup (add
mode) and delete the downtime again when the backup is finished (del mode).

Scheduling downtimes for planned downtimes gives you several advantages:

- No alerts are raised by planned downtimes
- The unplanned downtime in reporting is not affected by such downtimes

###############################################################################
# Prerequisites

- Perl
- Perl Modules:
	- LWP
	- Switch
	- Net::Ping
	- Sys::Hostname
	- Getopt::Long

###############################################################################
# Usage

You can use the provided init script to set up a basic downtime scheduling. In
some cases you may need to change the parameter in the init script calls or the
options in the nagios_downtime file to fit your needs. For example the options
for accessing the CGI files will be needed to be changed in most environments.

You basicaly have two ways to provide the options to the script:
a) via command line
b) via editing the options in the script

For details about the single command line parameters please execute

  nagios_downtime -h

You may change the basic like Nagios host, cgi path, cgi user and password 
using the options in the nagios_downtime script. This way you don't need to
provide the parameters on each call.

Examples:

	This command can be used to schedule a downtime of 15 minutes on the nagios
  host (nagios.my-domain.com). The CGIs are located at /nagios/cgi-bin. The
	CGIs can be accessed by the user nagiosadmin with password nagiosadmin. A 
  host-downtime for the host webserver.my-domain.com will be scheduled.

  nagios_downtime -m add -t 15 -S nagios.my-domain.com -p /nagios/cgi-bin \
                  -u nagiosadmin -P nagiosadmin -H webserver.my-domain.com

  With this command you can terminate the downtime. You need to have the
  saving of the downtime ids enabled (See next chapter

  nagios_downtime -m del -S nagios.my-domain.com -p /nagios/cgi-bin \
                  -u nagiosadmin -P nagiosadmin -H webserver.my-domain.com

###############################################################################
# Downtime deletion

The deletion of downtimes is a new feature in nagios_downtime 0.5.

You need to set the vars $storeDowntimeIds and $downtimePath in the head of the
nagios_downtime file to be able to use the feature. Once enabled newly
scheduled downtimes can be deleted by calling nagios_downtime in deletion mode
(-m del).

###############################################################################
# Bugs and Support

Please use the Nagios Portal (www.nagios-portal.org) in case of problems, bugs
and/or other comments. Even though it is a german board, english posts are 
welcome.

###############################################################################
# Thanks

Thanks to all supporters of open source solutions like Nagios. Keep up the
great work!

###############################################################################
